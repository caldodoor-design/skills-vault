---
name: implementing-review-feedback
description: コードレビューのフィードバックを体系的に処理・実装する。レビューコメントやPRフィードバックの対応時に使用。
trigger: レビューコメントの対応依頼、PRフィードバックの実装、レビュー指摘の修正
---

# レビューフィードバックの実装

コードレビューのフィードバックに基づいて、体系的に変更を処理・実装する。

## 使用タイミング

- レビュアーのコメントやフィードバックが提供された場合
- PRレビューの指摘への対応
- レビュー提案の実装依頼
- 「このコメントに対応して」「フィードバックを実装して」等の指示

## 体系的ワークフロー

### 1. レビューノートの解析

個別のフィードバック項目を特定:
- 番号付きリスト（1., 2. 等）を分割
- 箇条書きや番号なしフィードバックを処理
- 個別の変更要求を抽出
- 曖昧な項目は着手前に確認

### 2. Todoリストの作成

TodoWrite ツールでアクション可能なタスクを作成:
- 各フィードバック項目を1つ以上のtodoに変換
- 複雑なフィードバックは小さなタスクに分解
- タスクは具体的かつ測定可能に
- 最初のタスクを in_progress にしてから開始

例:
- extract関数に型ヒントを追加
- 重複タグ検出ロジックを修正
- chain.pyのdocstringを更新
- エッジケースのユニットテストを追加

### 3. 変更の体系的実装

各todo項目について:

**関連コードの特定:**
- Grep で関数/クラスを検索
- Glob でパターンによるファイル検索
- 現在の実装を読む

**変更の実施:**
- Edit ツールで修正
- プロジェクト規約に従う
- 動作変更が目的でない限り既存機能を維持

**変更の検証:**
- 構文の正確性を確認
- 該当テストがあれば実行
- レビュアーの意図に沿っているか確認

**ステータスの更新:**
- 完了後すぐにtodoを completed にマーク
- 次のtodoに移行（in_progress は常に1つだけ）

### 4. フィードバック種別ごとの対応

**コード変更:**
- Edit ツールで既存コードを修正
- 型ヒント規約に従う（PEP 604/585）
- 一貫したスタイルを維持

**新機能:**
- 必要に応じて Write ツールで新規ファイル作成
- 対応するテストを追加
- ドキュメントを更新

**ドキュメント:**
- プロジェクトスタイルに従ってdocstringを更新
- 必要に応じてmarkdownファイルを修正

**テスト:**
- テストは関数として記述（クラスではなく）
- 説明的な名前を使用
- pytest規約に従う

**リファクタリング:**
- 機能を維持
- コード構造を改善
- テストでリグレッションがないことを確認

### 5. バリデーション

変更実装後:
- 影響を受けるテストを実行
- Lintエラーを確認: uv run ruff check
- 既存機能が壊れていないことを検証

### 6. コミュニケーション

- Todoリストをリアルタイムで更新
- 曖昧なフィードバックには確認を求める
- ブロッカーや課題を報告
- 完了時に変更のサマリーを提示

## エッジケース

**矛盾するフィードバック:**
- ユーザーにガイダンスを求める
- 矛盾を明確に説明

**破壊的変更が必要:**
- 実装前にユーザーに通知
- 影響と代替案を議論

**変更後にテスト失敗:**
- todoを完了にする前にテストを修正
- 関連する全テストが通過することを確認

**参照コードが存在しない:**
- ユーザーに確認を求める
- 進行前に理解を検証

## 重要なガイドライン

- 進捗追跡には必ず TodoWrite を使用
- todo完了は即座にマーク（バッチ更新禁止）
- in_progress は常に1つだけ
- 不明確なフィードバックには質問する
- テスト対象コードの変更後はテスト実行
- 全コード変更でプロジェクト規約に従う

## 元リポジトリ

https://github.com/mhattingpete/engineering-workflow-plugin