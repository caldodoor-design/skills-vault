---
name: finishing-development-branch
description: 開発ブランチの完了処理を案内する。マージ、PR作成、保持、破棄の4つの選択肢を構造的に提示する。
trigger: 実装完了・テスト全通過後の統合判断時
---

# 開発ブランチの完了処理

## 概要

開発作業の完了時に、明確な選択肢を提示して選択されたワークフローを実行する。

**基本原則:** テスト検証 → 選択肢提示 → 選択実行 → クリーンアップ。

## プロセス

### ステップ1: テスト検証

選択肢提示前に、テストが通過していることを検証。
テスト失敗時はここで停止。ステップ2に進まない。

### ステップ2: ベースブランチの特定

git merge-base HEAD main または master で特定。

### ステップ3: 選択肢の提示

以下の4つを正確に提示:

1. ベースブランチにローカルマージ
2. プッシュしてPull Requestを作成
3. ブランチをそのまま保持（後で自分で対応）
4. この作業を破棄

説明は追加しない。簡潔に。

### ステップ4: 選択の実行

**選択肢1: ローカルマージ**
checkout → pull → merge → テスト → branch -d

**選択肢2: プッシュしてPR作成**
push -u origin → gh pr create

**選択肢3: そのまま保持**
報告のみ。Worktreeクリーンアップしない。

**選択肢4: 破棄**
削除内容を表示し discard の入力確認を待つ。
確認後 checkout → branch -D

### ステップ5: Worktreeクリーンアップ

選択肢1, 2, 4の場合: git worktree remove
選択肢3の場合: Workteeを保持。

## クイックリファレンス

| 選択肢 | マージ | プッシュ | Worktree保持 | ブランチ削除 |
|--------|--------|----------|-------------|-------------|
| 1. ローカルマージ | o | - | - | o |
| 2. PR作成 | - | o | o | - |
| 3. そのまま保持 | - | - | o | - |
| 4. 破棄 | - | - | - | o（強制） |

## よくあるミス

- テスト検証スキップで壊れたコードのマージ
- 曖昧な質問（4つの構造化選択肢を提示すること）
- 自動Worktreeクリーンアップ（選択肢1と4のみ）
- 破棄時の確認なし（discard入力必須）

## 禁止事項と必須事項

**禁止:** テスト失敗のまま進行、確認なし削除、無断force push
**必須:** テスト検証、4選択肢提示、選択肢4で入力確認、選択肢1/4のみクリーンアップ

## 連携

- using-git-worktrees で作成されたWorktreeのクリーンアップに使用

## 元リポジトリ

https://github.com/obra/superpowers